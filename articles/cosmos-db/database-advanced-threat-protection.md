---
title: 'Advanced Threat Protection for Azure Cosmos DB'
description: Learn how Azure Cosmos DB provides encryption of data at rest and how it's implemented.
author: monhaber
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 06/24/2019
ms.author: rimman
ms.author: sngun
ms.author: v-mohabe
ms.custom: seodec18
---

# Advanced Threat Protection for Azure Cosmos DB

Advanced Threat Protection for Azure Cosmos DB provides an additional layer of security intelligence that detects unusual and potentially harmful attempts to access or exploit Azure Cosmos DB accounts. This layer of protection allows you to address threats, even without being a security expert, and integrate them with central security monitoring systems.

Security alerts are triggered when anomalies in activity occur. These security alerts are integrated with  [Azure Security Center](https://azure.microsoft.com/services/security-center/), and are also sent via email to subscription administrators, with details of the suspicious activity and recommendations on how to investigate and remediate the threats.

> [!NOTE]
>
> * Advanced Threat Protection for Azure Cosmos DB is currently available only for the SQL API.
> * Advanced Threat Protection for Azure Cosmos DB is currently available in Azure government and sovereign cloud regions.

For a full investigation experience of the security alerts, we recommended enabling [diagnostic logging in Azure Cosmos DB](https://docs.microsoft.com/azure/cosmos-db/logging), which logs operations on the database itself, including CRUD operations on all documents, containers, and databases. 

## Set up Advanced Threat Protection 

### Set up ATP using the portal 

1. Launch the Azure portal at  [https://portal.azure.com](https://portal.azure.com/). 

2. From the Azure Cosmos DB account, from the **Settings** menu, select **Advanced security**.

    ![Set up ATP](./media/database-advanced-threat-protection/database-atp.png)

3. In the **Advanced security** configuration blade:

    * Click the **Advanced Threat Protection** option to set it to **ON**.
    * Click **Save** to save the new or updated Advanced Threat Protection policy.  

### Set up ATP using REST API 

Use Rest API commands to create, update, or get the Advanced Threat Protection setting for a specific Azure Cosmos DB account. 

* Advanced Threat Protection - Create 
* Advanced Threat Protection - Get 

### Set up ATP using Azure PowerShell 

Use the following PowerShell cmdlets: 

* [Enable Advanced Threat Protection](https://go.microsoft.com/fwlink/?linkid=2099607&clcid=0x409)
* [Get Advanced Threat Protection](https://go.microsoft.com/fwlink/?linkid=2099608&clcid=0x409)
* [Disable Advanced Threat Protection](https://go.microsoft.com/fwlink/?linkid=2099709&clcid=0x409)

Enable-AzSecurityAdvancedThreatProtection (Az.Security)The Enable-AzSecurityAdvancedThreatProtection cmdlet enables the threat protetion policy for a storage account. To use this cmdlet, specify the ResourceId parameter. go.microsoft.com

### Manage ATP security alerts

When Azure Cosmos DB activity anomalies occur, a security alert is triggered with information about the suspicious security event. You receive an email notification with information about the suspicious security event. The email also includes details on possible causes and recommended actions to investigate and mitigate the potential threat.
The alert details include:

    ![Alert details](./media/database-advanced-threat-protection/database-alert.png)

 From Azure Security Center, you can review and manage your current [security alerts](../security-center/security-center-alerts-overview.md) Click on a specific alert in the [portal](https://ms.portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) to [view](tutorial-query-graph.md) possible causes and recommended actions to investigate and mitigate the potential threat.

 ![Threat details](./media/database-advanced-threat-protection/database-alert-details.png)

## Advanced Threat Protection alerts 

Alerts are generated by unusual and potentially harmful attempts to access or exploit Azure Cosmos DB accounts. To see the alerts available, see   The following events can trigger the following alerts:

 |Alert|Description|Potential causes can be:|
|---|---|---|
|**Access from unusual location**|Indicates that there was a change in the access pattern to a Cosmos DB account. Someone has accessed this account from an unfamiliar IP address compared to recent activity.|  <ul><li>An attacker has accessed a Cosmos DB account.</li><li>A legitimate user has accessed the Cosmos DB account from a new and unusual geographical location. For example: a new application or developer maintenance from remote.</li></ul>|
|**Unusual  data exfiltration**|Indicates that there was a change in the data extraction pattern from a Cosmos DB account. Someone has extracted an unusual amount of data compared to recent activity.|<ul><li>An attacker has extracted a large amount of data from a Cosmos DB database. For example: data exfiltration/leakage, unauthorized transfer of data.</li><li>A legitimate user or application has extracted an unusual amount of data from a container. For example: maintenance backup activity.</li></ul>|

Next steps

* Learn more about [Diagnostic logging in Azure Cosmos DB](https://docs.microsoft.com/azure/cosmos-db/logging#turn-on-logging-in-the-azure-portal)
* Learn more about [Azure Security Center](https://docs.microsoft.com/azure/security-center/security-center-intro)